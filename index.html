<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Home - Homey RFDriver</title>

  <meta property="og:image" content="https://etc.athom.com/logo/white/256.png" />
  <link rel="icon" href="https://etc.athom.com/logo/transparent/128.png" />
  <link rel="icon" type="image/png" href="https://etc.athom.com/logo/transparent/128.png" />
  <link rel="preload" as="image" href="images/logo.png">
  <link rel="preload" href="styles/homey.min.css" as="style">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link rel="preconnect" href="styles/atom-one-light.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500&family=Roboto:wght@100;300;400;500;700&display=swap"
        rel="stylesheet">
  <link type="text/css" rel="stylesheet" href="styles/homey.min.css">
</head>

<body>
<div class="container">
  <nav class="navigation container__navigation component">
    <header class="navigation__header">
                <div class="navigation__logo"><a href="index.html"><img class="display-block" src="images/logo.png" width="40" height="40" alt="Homey"></a></div>
                <h2 class="navigation__title"><a href="index.html">Homey RFDriver</a></h2>
                <button data-navigation-toggle class="navigation__button" title="menu"></button>
             </header><div class="navigation__content" data-navigation-target><div class="navigation__search search">
            <input title="filter" placeholder="Filter..." data-navigation-search class="search__input" type="search">
            <button data-navigation-search-reset class="search__reset --mask" type="button" title="Reset"></button>
           </div><div data-navigation-scroll class="navigation__scroll scroll trim"><div class="navigation__menu trim"><nav class="nav-group"><h3 class="nav-group__title">Classes</h3><ul class="nav-group__list"><li data-search-key="rfdevice" class="nav-group__item"><a href="RFDevice.html">RFDevice</a></li><li data-search-key="rfdriver" class="nav-group__item"><a href="RFDriver.html">RFDriver</a></li><li data-search-key="rferror" class="nav-group__item"><a href="RFError.html">RFError</a></li><li data-search-key="rfsignal" class="nav-group__item"><a href="RFSignal.html">RFSignal</a></li><li data-search-key="rfutil" class="nav-group__item"><a href="RFUtil.html">RFUtil</a></li></ul></nav></div></div></div>
  </nav>

  <main id="main" class="main container__main">
    
  
  


  
  
  <div class="main__center">
    <div class="main__content align-baseline main-page trim">
      




    <section>
        <article class="main-page__content"><h1>Homey RFDriver</h1>
<p><a href="https://www.npmjs.com/package/homey-rfdriver"><img src="https://img.shields.io/npm/v/homey-rfdriver" alt="npm"></a> <a href="https://github.com/athombv/node-homey-rfdriver/actions/workflows/lint.yml"><img src="https://github.com/athombv/node-homey-rfdriver/actions/workflows/lint.yml/badge.svg?branch=master" alt="Lint"></a> <a href="https://github.com/athombv/node-homey-rfdriver/actions/workflows/deploy.yml"><img src="https://github.com/athombv/node-homey-rfdriver/actions/workflows/deploy.yml/badge.svg" alt="NPM"></a> <a href="https://github.com/athombv/node-homey-rfdriver/actions/workflows/docs.yml"><img src="https://github.com/athombv/node-homey-rfdriver/actions/workflows/docs.yml/badge.svg?branch=master" alt="Deploy Documentation To GitHub Pages"></a></p>
<p>This module helps developers create RF (433MHz, 868MHz, Infrared) apps for Homey.</p>
<p>This module requires Homey Apps SDK v3.</p>
<h2>Documentation</h2>
<p>Documentation is available at <a href="https://athombv.github.io/node-homey-rfdriver/">https://athombv.github.io/node-homey-rfdriver/</a>.</p>
<h2>Related Modules</h2>
<ul>
<li><a href="https://athombv.github.io/node-homey-zwavedriver">node-homey-zwavedriver</a> — Module for Z-Wave drivers</li>
<li><a href="https://athombv.github.io/node-homey-zigbeedriver">node-homey-zigbeedriver</a> — Module for Zigbee drivers</li>
<li><a href="https://athombv.github.io/node-homey-oauth2app">node-homey-oauth2app</a> — Module for OAuth2 apps</li>
<li><a href="https://athombv.github.io/node-homey-log">node-homey-log</a> — Module to log unhandled errors to Sentry</li>
</ul>
<h2>Installation</h2>
<pre class="prettyprint source lang-bash"><code>$ npm install homey-rfdriver
</code></pre>
<h2>Requirements</h2>
<ul>
<li>This module requires <a href="https://apps-sdk-v3.developer.homey.app/">Homey Apps SDK v3</a>.</li>
<li>Your app needs <a href="https://apps.developer.homey.app/the-basics/app/permissions">permission</a> for either <code>homey:wireless:433</code> or <code>homey:wireless:ir</code>.</li>
</ul>
<h2>Usage</h2>
<p>Both your driver and device should extend RFDriver and RFDevice. RFDriver should then reference another class that extends RFSignal.</p>
<p>A typical app might have these files:</p>
<pre class="prettyprint source"><code>/.homeycompose/signals/433/my_signal.json
/lib/MySignal.js (extends RFSignal)
/drivers/my_driver/driver.js (extends RFDriver)
/drivers/my_driver/device.js (extends RFDevice)
/drivers/my_driver/pair/rf_receiver_learn.html
/drivers/my_driver/pair/rf_receiver_add.html
/drivers/my_driver/pair/image.svg
</code></pre>
<p>Your driver can be either a <em>transmitter</em> (e.g. a remote) or a <em>receiver</em> (e.g. a light or socket switch).</p>
<p>You should copy the corresponding files from this module's <code>/pair</code> folder to your driver's <code>/pair</code> folder.</p>
<h3>RFSignal</h3>
<p>Imagine we have a simple 433 MHz protocol that first sends the address (1 byte) and then the on/off state (1 byte, <code>0x00</code> for off, <code>0xFF</code> for on).</p>
<p>Our signal definition must be added to <code>/.homeycompose/signals/433/my_signal.json</code>. Refer to the <a href="https://apps.developer.athom.com/tutorial-Signals.html">Signal Documentation</a> for more information on how to create a signal.</p>
<p>Your JSON describes how to encode and decode the low &amp; high signals into bits.
The RFSignal you define here will parse these bits (or bytes) from and to JavaScript objects.</p>
<p><code>/lib/my_signal.js</code></p>
<pre class="prettyprint source lang-javascript"><code>'use strict';

const { RFSignal, RFError, RFUtil } = require('homey-rfdriver');

// Protocol:
// [ 0x00 - 0xFF, 0x00 | 0xFF ]
// [ address    , state       ]

module.exports = class extends RFSignal {

  static FREQUENCY = '433';
  static ID = 'my_signal';

  // This method converts a JavaScript object command
  // into a payload for our signal.
  static commandToPayload({ address, state }) {
    if( typeof address !== 'number' )
      throw new RFError('Invalid Address');

    if( typeof state !== 'boolean' )
      throw new RFError('Invalid State');
      
    return [ address, state ? 0x00 : 0xFF ];
  }

  // This method converts a received payload
  // into a JavaScript object command.
  static payloadToCommand(payload) {
    const address = Number(payload[0]);
    const state = Boolean(payload[1]);
    return { address, state };
  }

  // This method takes a command object
  // and returns a device-unique data object
  static commandToDeviceData(command) {
    return {
      address: command.address,
    };
  }

  // This method is invoked when a new receiver is added
  // We can generate a random address, as if someone pressed
  // the button on a remote.
  static createPairCommand() {
    return {
      address: Math.round(Math.random() * 255),
      state: true,
    };
  }

}
</code></pre>
<h3>RFDriver</h3>
<p><code>/drivers/my_driver/driver.js</code></p>
<pre class="prettyprint source lang-javascript"><code>const { RFDriver } = require('homey-rfdriver');
const MySignal = require('../../lib/MySignal');

module.exports = class extends RFDriver {

  static SIGNAL = MySignal;

}
</code></pre>
<h4>Transmitter</h4>
<p>Copy <code>/pair/rf_transmitter_learn.html</code> to your driver's <code>/pair</code> folder.</p>
<p>Then add this to your <code>/drivers/&lt;driver_id&gt;/driver.compose.json</code>:</p>
<pre class="prettyprint source lang-json"><code>&quot;pair&quot;: [
  {
    &quot;id&quot;: &quot;rf_transmitter_learn&quot;,
    &quot;options&quot;: {
      &quot;title&quot;: {
        &quot;en&quot;: &quot;Press any button&quot;
      },
      &quot;instruction&quot;: {
        &quot;en&quot;: &quot;Press any button on your device.&quot;
      }
    }
  }
]
</code></pre>
<h4>Receiver</h4>
<p>Copy <code>/pair/rf_receiver_learn.html</code> and <code>/pair/rf_receiver_add.html</code> to your driver's <code>/pair</code> folder.</p>
<p>Then add this to your <code>/drivers/&lt;driver_id&gt;/driver.compose.json</code>:</p>
<pre class="prettyprint source lang-json"><code>&quot;pair&quot;: [
  {
    &quot;id&quot;: &quot;rf_receiver_learn&quot;,
    &quot;navigation&quot;: {
      &quot;next&quot;: &quot;rf_receiver_add&quot;
    },
    &quot;options&quot;: {
      &quot;title&quot;: {
        &quot;en&quot;: &quot;Press the button...&quot;
      },
      &quot;instruction&quot;: {
        &quot;en&quot;: &quot;Press the button on your device once.&quot;
      }
    }
  },
  {
    &quot;id&quot;: &quot;rf_receiver_add&quot;,
    &quot;options&quot;: {
      &quot;instruction&quot;: {
        &quot;en&quot;: &quot;Did the device turn off and on?&quot;
      }
    }
  }
]
</code></pre>
<blockquote>
<p>To present the user with a choice whether to copy a remote, or let Homey generate a new code, use the <code>/pair/rf_receiver_copy_or_create.html</code> template. Then include both <em>receiver</em> and <em>transmitter</em> pair in your <code>driver.compose.json</code>.</p>
</blockquote>
<h4>IR Remote</h4>
<p>Copy <code>/pair/rf_ir_remote_learn.html</code> and <code>/pair/rf_ir_remote_add</code> to your driver's <code>/pair</code> folder.</p>
<p>Then add this to your <code>/drivers/&lt;driver_id&gt;/driver.compose.json</code>:</p>
<pre class="prettyprint source lang-json"><code>&quot;pair&quot;: [
  {
    &quot;id&quot;: &quot;rf_ir_remote_learn&quot;,
    &quot;navigation&quot;: {
      &quot;next&quot;: &quot;rf_ir_remote_add&quot;
    },
    &quot;options&quot;: {
      &quot;title&quot;: {
        &quot;en&quot;: &quot;Pair your IR remote&quot;,
        &quot;nl&quot;: &quot;Koppel je IR afstandsbediening&quot;
      },
      &quot;instruction&quot;: {
        &quot;en&quot;: &quot;Press next to pair your remote.&quot;,
        &quot;nl&quot;: &quot;Druk op volgende om je afstandsbediening te koppelen.&quot;
      }
    }
  },{
    &quot;id&quot;: &quot;rf_ir_remote_add&quot;
  }
]
</code></pre>
<h3>RFDevice</h3>
<p><code>/drivers/my_driver/device.js</code></p>
<pre class="prettyprint source lang-javascript"><code>const { RFDevice } = require('homey-rfdriver');

module.exports = class extends RFDriver {

  static RX_ENABLED = false; // Set to true for transmitter devices

  static CAPABILITIES = {

    // When the onoff capability is changed by the user,
    // you can assemble a command here.
    // 'data' is your device's data object
    onoff: ({ value, data }) => ({
      address: data.address,
      state: value === true,
    }),
  };

}
</code></pre></article>
    </section>


    </div>
  </div>
  



  </main>
</div>

<script src="scripts/ready.js"></script>
<script src="scripts/navigation.js"></script>
<script src="scripts/toc.js"></script>

<link type="text/css" rel="stylesheet" href="styles/atom-one-light.css">
<script src="scripts/highlight.min.js"></script>
<!--<script src="scripts/linenumber.js"></script>-->

<script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
<noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript>

</body>
</html>